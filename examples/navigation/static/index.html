<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>Elm Navigation Example</title>
  </head>
  <body>
    <div id="app"></div>
    <script src="elm.js"></script>
    <script>
      var app = Elm.Main.init({
        node: document.getElementById("app"),
        flags: location.href,
      });

      function sendNavigation(state) {
        app.ports.onNavigation.send({ href: location.href, state: state });
      }

      app.ports.navigationOut.subscribe(function (msg) {
        switch (msg.tag) {
          case "pushUrl":
            history.pushState(null, "", msg.url);
            sendNavigation(null);
            break;
          case "pushState":
            history.pushState(msg.state, "");
            sendNavigation(msg.state);
            break;
          case "replaceUrl":
            history.replaceState(history.state, "", msg.url);
            // No sendNavigation â€” Elm is not notified
            break;
        }
      });

      window.addEventListener("popstate", function (event) {
        sendNavigation(event.state);
      });
    </script>
  </body>
</html>
